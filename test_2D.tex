
\subsection{Двухмерная задача просачивания с источником на границе}
Рассмотрим двумерную область пористой среды, имеющую форму
прямоугольника. Пористость и абсолютная проницаемость породы постоянны во всем
объеме. Параметры модели такие же, как
в первой тестовой задаче.
Во всей области задаем следующее 
начальное распределение: $S_w=0.4$,\; $S_n=0.35$,\; $S_g=0.25$, 
$P_w=P_\text{атм}+\rho g h$($h$ - глубина, отсчитывается от верхнего края области).
Пусть размер области -- $N_x\cdot N_y$.
Граничную поверхность, кроме части верхней границы, считаем непроницаемой, 
что может быть интерпретировано так,
что среда огорожена непроницаемым резервуаром, имеющим сверху отверстие с
координатами: $(N_x/3, N_y)$, $(2N_x/3, N_y)$. Через отверстие происходит обмен веществом между 
резервуаром и окружающей средой. На отверстии заданы условия: $P_w=P_\text{атм}$,

$ \dfrac{\partial S_w}{\partial t}= 
\begin{cases}
 q, \; S_w<S_{max}\\
 0, \; \text{иначе}
\end{cases}
$,
$ \dfrac{\partial S_n}{\partial t}=-q S_n$.

\begin{figure}
\begin{center}
\begin{minipage}[h]{0.48\textwidth}
\begin{tikzpicture}
  \begin{axis}[view={0}{90}, enlargelimits=false, xlabel={$x$, м}, ylabel={$y$, м}, colorbar, width=0.8\textwidth, height=0.8\textwidth, point meta min=100000, point meta max=110000]
    \pgfplotstableread[skip first n=3]{data/test3/F-000000000100.tec}{\mytable}
    \addplot3 [surf, shader=interp] table [x=0, y=1, z=5] {\mytable};
  \end{axis}
\end{tikzpicture}
\caption{Давление $P_w$ в момент времени $t=100$с}
\end{minipage}
\hfill
\begin{minipage}[h]{0.48\textwidth}
\begin{tikzpicture}
  \begin{axis}[view={0}{90}, enlargelimits=false, xlabel={$x$, м}, ylabel={$y$, м}, colorbar, width=0.8\textwidth, height=0.8\textwidth, point meta min=285, point meta max=320]
    \pgfplotstableread[skip first n=3]{data/test3/F-000000000100.tec}{\mytable}
    \addplot3 [surf, shader=interp] table [x=0, y=1, z=6] {\mytable};
  \end{axis}
\end{tikzpicture}
\caption{Температура в момент времени $t=1000$с}
\end{minipage}
\vfill
\begin{minipage}[h]{0.48\textwidth}
\begin{tikzpicture}
  \begin{axis}[view={0}{90}, enlargelimits=false, xlabel={$x$, м}, ylabel={$y$, м}, colorbar, width=0.8\textwidth, height=0.8\textwidth, point meta min=100000, point meta max=110000]
    \pgfplotstableread[skip first n=3]{data/test3/F-000000001000.tec}{\mytable}
    \addplot3 [surf, shader=interp] table [x=0, y=1, z=5] {\mytable};
  \end{axis}
\end{tikzpicture}
\caption{Давление $P_w$ в момент времени $t=1000$с}
\end{minipage}
\hfill
\begin{minipage}[h]{0.48\textwidth}
\begin{tikzpicture}
  \begin{axis}[view={0}{90}, enlargelimits=false, xlabel={$x$, м}, ylabel={$y$, м}, colorbar, width=0.8\textwidth, height=0.8\textwidth, point meta min=285, point meta max=320]
    \pgfplotstableread[skip first n=3]{data/test3/F-000000001000.tec}{\mytable}
    \addplot3 [surf, shader=interp] table [x=0, y=1, z=6] {\mytable};
  \end{axis}
\end{tikzpicture}
\caption{Температура в момент времени $t=1000$с}
\end{minipage}
\vfill
\begin{minipage}[h]{0.48\textwidth}
\begin{tikzpicture}
  \begin{axis}[view={0}{90}, enlargelimits=false, xlabel={$x$, м}, ylabel={$y$, м}, colorbar, width=0.8\textwidth, height=0.8\textwidth, point meta min=100000, point meta max=110000]
    \pgfplotstableread[skip first n=3]{data/test3/F-000000007000.tec}{\mytable}
    \addplot3 [surf, shader=interp] table [x=0, y=1, z=5] {\mytable};
  \end{axis}
\end{tikzpicture}
\caption{Давление $P_w$ в момент времени $t=7000$с}
\end{minipage}
\hfill
\begin{minipage}[h]{0.48\textwidth}
\begin{tikzpicture}
  \begin{axis}[view={0}{90}, enlargelimits=false, xlabel={$x$, м}, ylabel={$y$, м}, colorbar, width=0.8\textwidth, height=0.8\textwidth, point meta min=285, point meta max=320]
    \pgfplotstableread[skip first n=3]{data/test3/F-000000007000.tec}{\mytable}
    \addplot3 [surf, shader=interp] table [x=0, y=1, z=6] {\mytable};
  \end{axis}
\end{tikzpicture}
\caption{Температура в момент времени $t=7000$с}
\end{minipage}
\end{center}
\end{figure}
\begin{figure}
\begin{center}
\begin{minipage}[h]{0.48\textwidth}
\begin{tikzpicture}
  \begin{axis}[view={0}{90}, enlargelimits=false, xlabel={$x$, м}, ylabel={$y$, м}, colorbar, width=0.8\textwidth, height=0.8\textwidth, point meta min=0.1, point meta max=0.6]
    \pgfplotstableread[skip first n=3]{data/test3/F-000000000100.tec}{\mytable}
    \addplot3 [surf, shader=interp] table [x=0, y=1, z=2] {\mytable};
  \end{axis}
\end{tikzpicture}
\caption{Насыщенность $S_w$ в момент времени $t=100$с}
\end{minipage}
\hfill
\begin{minipage}[h]{0.48\textwidth}
\begin{tikzpicture}
  \begin{axis}[view={0}{90}, enlargelimits=false, xlabel={$x$, м}, ylabel={$y$, м}, colorbar, width=0.8\textwidth, height=0.8\textwidth, point meta min=0.1, point meta max=0.48]
    \pgfplotstableread[skip first n=3]{data/test3/F-000000000100.tec}{\mytable}
    \addplot3 [surf, shader=interp] table [x=0, y=1, z=3] {\mytable};
  \end{axis}
\end{tikzpicture}
\caption{Насыщенность $S_n$ в момент времени $t=100$с}
\end{minipage}
\vfill
\begin{minipage}[h]{0.48\textwidth}
\begin{tikzpicture}
  \begin{axis}[view={0}{90}, enlargelimits=false, xlabel={$x$, м}, ylabel={$y$, м}, colorbar, width=0.8\textwidth, height=0.8\textwidth, point meta min=0.1, point meta max=0.6]
    \pgfplotstableread[skip first n=3]{data/test3/F-000000001000.tec}{\mytable}
    \addplot3 [surf, shader=interp] table [x=0, y=1, z=2] {\mytable};
  \end{axis}
\end{tikzpicture}
\caption{Насыщенность $S_w$ в момент времени $t=1000$с}
\end{minipage}
\hfill
\hfill
\begin{minipage}[h]{0.48\textwidth}
\begin{tikzpicture}
  \begin{axis}[view={0}{90}, enlargelimits=false, xlabel={$x$, м}, ylabel={$y$, м}, colorbar, width=0.8\textwidth, height=0.8\textwidth, point meta min=0.1, point meta max=0.48]
    \pgfplotstableread[skip first n=3]{data/test3/F-000000001000.tec}{\mytable}
    \addplot3 [surf, shader=interp] table [x=0, y=1, z=3] {\mytable};
  \end{axis}
\end{tikzpicture}
\caption{Насыщенность $S_n$ в момент времени $t=1000$с}
\end{minipage}
\vfill
\begin{minipage}[h]{0.48\textwidth}
\begin{tikzpicture}
  \begin{axis}[view={0}{90}, enlargelimits=false, xlabel={$x$, м}, ylabel={$y$, м}, colorbar, width=0.8\textwidth, height=0.8\textwidth, point meta min=0.1, point meta max=0.6]
    \pgfplotstableread[skip first n=3]{data/test3/F-000000007000.tec}{\mytable}
    \addplot3 [surf, shader=interp] table [x=0, y=1, z=2] {\mytable};
  \end{axis}
\end{tikzpicture}
\caption{Насыщенность $S_w$ вТемпература момент времени $t=7000$с}
\end{minipage}
\hfill
\begin{minipage}[h]{0.48\textwidth}
\begin{tikzpicture}
  \begin{axis}[view={0}{90}, enlargelimits=false, xlabel={$x$, м}, ylabel={$y$, м}, colorbar, width=0.8\textwidth, height=0.8\textwidth, point meta min=0.1, point meta max=0.48]
    \pgfplotstableread[skip first n=3]{data/test3/F-000000007000.tec}{\mytable}
    \addplot3 [surf, shader=interp] table [x=0, y=1, z=3] {\mytable};
  \end{axis}
\end{tikzpicture}
\caption{Насыщенность $S_n$ в момент времени $t=7000$с}
\end{minipage}
\end{center}
\end{figure}
\begin{figure}
\begin{center}
\begin{minipage}[h]{0.48\textwidth}
\begin{tikzpicture}
  \begin{axis}[view={0}{90}, enlargelimits=false, xlabel={$x$, м}, ylabel={$y$, м}, colorbar, width=0.8\textwidth, height=0.8\textwidth, point meta min=0.1, point meta max=0.48]
    \pgfplotstableread[skip first n=3]{data/test3/F-000000000100.tec}{\mytable}
    \addplot3 [surf, shader=interp] table [x=0, y=1, z=4] {\mytable};
  \end{axis}
\end{tikzpicture}
\caption{Насыщенность $S_g$ в момент времени $t=100$с}
\end{minipage}
\vfill
\begin{minipage}[h]{0.48\textwidth}
\begin{tikzpicture}
  \begin{axis}[view={0}{90}, enlargelimits=false, xlabel={$x$, м}, ylabel={$y$, м}, colorbar, width=0.8\textwidth, height=0.8\textwidth, point meta min=0.1, point meta max=0.48]
    \pgfplotstableread[skip first n=3]{data/test3/F-000000001000.tec}{\mytable}
    \addplot3 [surf, shader=interp] table [x=0, y=1, z=4] {\mytable};
  \end{axis}
\end{tikzpicture}
\caption{Насыщенность $S_g$ в момент времени $t=1000$с}
\end{minipage}
\vfill
\begin{minipage}[h]{0.48\textwidth}
\begin{tikzpicture}
  \begin{axis}[view={0}{90}, enlargelimits=false, xlabel={$x$, м}, ylabel={$y$, м}, colorbar, width=0.8\textwidth, height=0.8\textwidth, point meta min=0.1, point meta max=0.48]
    \pgfplotstableread[skip first n=3]{data/test3/F-000000007000.tec}{\mytable}
    \addplot3 [surf, shader=interp] table [x=0, y=1, z=4] {\mytable};
  \end{axis}
\end{tikzpicture}
\caption{Насыщенность $S_g$ в момент времени $t=7000$с}
\end{minipage}
\end{center}
\end{figure}


\subsection{Задача о перераспределении фаз под действием силы тяжести в резервуаре}
Рассмотрим одномерную модельную задачу неизотермической трехфазной фильтрации,
где перераспределение фаз в резервуаре происходит под действием силы
тяжести при нагревании верхней границы области. Резервуар сверху открыт, а его нижняя
граница является непроницаемой для фаз.
Считаем, что самый верхний слой почти полностью занят газом.  
Ось $x$ направлена сверху-вниз.\\
Начальные условия:
\begin{equation}
 S_w=0.4,\\
 S_n=0.3,\\
 S_g=0.3,\\ 
 P_w=P_\text{атм},\\
 T=285K.
\end{equation}
Граничные условия:
\begin{equation}
  \begin{aligned}
    &\left.T\right|_{x=0}=320K,\quad \left.T\right|_{x=1}=285K;\\
    &\left.P_i\right|_{x=0}=P_{\text{атм}},\quad \left.{P_i}\right|_{x=1}\text{ определяется из условия } \left.\overrightarrow{u_i}\right|_{x=1}\text=0;\\
    &\left.S_w\right|_{x=0}=0.01,\quad \Biggl.\dfrac{\partial{S_w}}{\partial{x}}\Biggr|_{x=1}=0;\\
    &\left.S_n\right|_{x=0}=0.01,\quad \Biggl.\dfrac{\partial{S_n}}{\partial{x}}\Biggr|_{x=1}=0.
  \end{aligned}
\end{equation}

Результаты расчетов представлены в~ виде зависимостей профилей насыщенностей фаз,
распределения давления и~ температуры от~ времени на Рис.~\ref{t1_pic_start} - Рис.~\ref{t1_pic_end}. На графиках можно видеть,
как выравнивается давление, как распространяется тепловой фронт, а по изменению распределения
насыщенностей -- как происходит замещение одних фаз другими. Благодаря высокой подвижности и большой разнице в плотности
по сравнению с другими фазами газ вытесняется в первую очередь, затем вода вытесняет нефть. 

\begin{figure}[h!]
\begin{center}
\begin{minipage}[h]{0.49\textwidth}
\begin{tikzpicture}
  \begin{axis}[legend entries={$S_w$,$S_n$,$S_g$}, axis lines=left, ymax=1, ymin=0, enlargelimits=true, grid=major, width=1\textwidth, xlabel={$x$, м}, ylabel={$S$}]
    \pgfplotstableread[skip first n=3]{data/test2/F-000000004000.tec}{\mytable}
    \addplot [blue, ultra thick] table [x expr=1-\thisrow{0}, y=1] {\mytable};
    \addplot [black, ultra thick] table [x expr=1-\thisrow{0}, y=2] {\mytable};
    \addplot [red, ultra thick] table [x expr=1-\thisrow{0}, y=3] {\mytable};
  \end{axis}
\end{tikzpicture}
\caption{Насыщенности в момент времени $t=4000$с}
\label{t1_pic_start}
\end{minipage}
\hfill
\begin{minipage}[h]{0.49\textwidth}
\begin{tikzpicture}
  \begin{axis}[legend entries={$S_w$,$S_n$,$S_g$}, axis lines=left, ymax=1, ymin=0, enlargelimits=true, grid=major, width=1\textwidth, xlabel={$x$, м}, ylabel={$S$}]
    \pgfplotstableread[skip first n=3]{data/test2/F-000000010000.tec}{\mytable}
    \addplot [blue, ultra thick] table [x expr=1-\thisrow{0}, y=1] {\mytable};
    \addplot [black, ultra thick] table [x expr=1-\thisrow{0}, y=2] {\mytable};
    \addplot [red, ultra thick] table [x expr=1-\thisrow{0}, y=3] {\mytable};
  \end{axis}
\end{tikzpicture}
\caption{Насыщенности в момент времени $t=10000$с}
\end{minipage}
\vfill
\begin{minipage}[h]{0.49\textwidth}
\begin{tikzpicture}
  \begin{axis}[axis lines=left, ymax=105000, ymin=100000, enlargelimits=true, grid=major, width=1\textwidth, xlabel={$x$, м}, ylabel={$P$, Па}]
    \pgfplotstableread[skip first n=3]{data/test2/F-000000004000.tec}{\mytable}
    \addplot [blue, ultra thick] table [x expr=1-\thisrow{0}, y=4] {\mytable};
  \end{axis}
\end{tikzpicture}
\caption{Давление $P_w$ в момент времени $t=4000$с}
\end{minipage}
\hfill
\begin{minipage}[h]{0.49\textwidth}
\begin{tikzpicture}
  \begin{axis}[axis lines=left, ymax=105000, ymin=100000, enlargelimits=true, grid=major, width=1\textwidth, xlabel={$x$, м}, ylabel={$P$, Па}]
    \pgfplotstableread[skip first n=3]{data/test2/F-000000010000.tec}{\mytable}
    \addplot [blue, ultra thick] table [x expr=1-\thisrow{0}, y=4] {\mytable};
  \end{axis}
\end{tikzpicture}
\caption{Давление $P_w$ в момент времени $t=10000$с}
\end{minipage}
\vfill
\begin{minipage}[h]{0.49\textwidth}
\begin{tikzpicture}
  \begin{axis}[axis lines=left, ymax=320, ymin=285, enlargelimits=true, grid=major, width=1\textwidth, xlabel={$x$, м}, ylabel={$T$, К}]
    \pgfplotstableread[skip first n=3]{data/test2/F-000000004000.tec}{\mytable}
    \addplot [blue, ultra thick] table [x expr=1-\thisrow{0}, y=5] {\mytable};
  \end{axis}
\end{tikzpicture}
\caption{Температура в момент времени $t=4000$с}
\end{minipage}
\hfill
\begin{minipage}[h]{0.49\textwidth}
\begin{tikzpicture}
  \begin{axis}[axis lines=left, ymax=320, ymin=285, enlargelimits=true, grid=major, width=1\textwidth, xlabel={$x$, м}, ylabel={$T$, К}]
    \pgfplotstableread[skip first n=3]{data/test2/F-000000010000.tec}{\mytable}
    \addplot [blue, ultra thick] table [x expr=1-\thisrow{0}, y=5] {\mytable};
  \end{axis}
\end{tikzpicture}
\caption{Температура в момент времени $t=10000$с}
\label{t1_pic_end}
\end{minipage}
\end{center}
\end{figure}
